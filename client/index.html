<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#3b82f6">
    <title>Blaulicht Atlas 24 - Live Polizeieins√§tze Deutschland</title>
    <meta name="description" content="Live-Karte der Polizeieins√§tze in Deutschland - Aktuelle Vorf√§lle aus den letzten 24 Stunden">
    
    <!-- Preconnect to external resources -->
    <link rel="preconnect" href="https://unpkg.com">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- Modern font loading -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
          crossorigin=""/>
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="styles.css">
    
    <!-- Enhanced Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><circle cx='50' cy='50' r='45' fill='%233b82f6'/><text x='50' y='65' font-size='50' text-anchor='middle' fill='white'>üöî</text></svg>">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><circle cx='50' cy='50' r='45' fill='%233b82f6'/><text x='50' y='65' font-size='50' text-anchor='middle' fill='white'>üöî</text></svg>">
</head>
<body>
    <!-- Navigation Header -->
    <header class="app-header">
        <div class="header-container">
            <div class="header-brand">
                <span class="brand-icon">üöî</span>
                <div>
                    <h1 class="brand-title">Blaulicht Atlas 24</h1>
                    <div class="brand-subtitle">Live Polizeieins√§tze</div>
                </div>
            </div>
            
            <!-- Status Indicator -->
            <div class="header-status">
                <div class="status-indicator">
                    <div class="status-dot" id="statusDot"></div>
                    <div class="status-info">
                        <span class="status-text" id="statusText">L√§dt...</span>
                        <span class="status-subtext" id="statusSubtext">Verbindung wird hergestellt</span>
                    </div>
                </div>
                
                <!-- Mobile Filter Toggle -->
                <button class="mobile-filter-toggle" id="mobileFilterToggle" aria-label="Filter anzeigen">
                    <span class="hamburger"></span>
                    <span class="hamburger"></span>
                    <span class="hamburger"></span>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Application Container -->
    <main class="app-main">
        <!-- Desktop Filter Sidebar -->
        <aside class="filter-sidebar" id="filterSidebar">            
            <div class="sidebar-content" id="desktopFilters">
                <!-- Fallback content while filters load -->
                <div class="filter-section">
                    <h3 class="filter-label">Zeitraum</h3>
                    <div class="checkbox-group">
                        <label class="checkbox-item">
                            <input type="checkbox" id="fallback-last24h" checked>
                            <span class="checkmark"></span>
                            <span class="checkbox-text">Nur letzte 24 Stunden</span>
                        </label>
                    </div>
                </div>
                
                <div class="filter-section">
                    <h3 class="filter-label">Schweregrad</h3>
                    <select class="custom-select">
                        <option value="low">Alle anzeigen</option>
                        <option value="medium">Mittel und h√∂her</option>
                        <option value="high">Hoch und h√∂her</option>
                        <option value="critical">Nur kritisch</option>
                    </select>
                </div>
                
                <div class="filter-section">
                    <button class="btn btn-primary" id="refreshButton">
                        <span class="btn-icon">üîÑ</span>
                        Aktualisieren
                    </button>
                </div>
                
                <div class="statistics-section">
                    <h3 class="stats-title">Statistiken</h3>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-number" id="totalIncidents">-</div>
                            <div class="stat-label">Gesamt</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="visibleIncidents">-</div>
                            <div class="stat-label">Angezeigt</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="activeIncidents">-</div>
                            <div class="stat-label">Aktiv</div>
                        </div>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Map Container -->
        <section class="map-container">
            <div id="map" class="map"></div>
            
            <!-- Loading Overlay -->
            <div class="overlay loading-overlay hidden" id="loadingOverlay">
                <div class="overlay-content">
                    <div class="loading-animation">
                        <div class="spinner"></div>
                        <div class="loading-dots">
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                    </div>
                    <h3 class="overlay-title">Lade Polizeieins√§tze</h3>
                    <p class="overlay-text">Aktuelle Daten werden abgerufen...</p>
                </div>
            </div>
            
            <!-- Error Overlay -->
            <div class="overlay error-overlay hidden" id="errorOverlay">
                <div class="overlay-content">
                    <div class="error-animation">
                        <div class="error-icon">‚ö†Ô∏è</div>
                    </div>
                    <h3 class="error-title">Fehler beim Laden</h3>
                    <p class="error-message" id="errorMessage">Die Daten konnten nicht geladen werden.</p>
                    <button class="btn btn-primary" id="retryLoad">
                        <span class="btn-icon">üîÑ</span>
                        Erneut versuchen
                    </button>
                </div>
            </div>
        </section>
    </main>

    <!-- Mobile Filter Panel -->
    <div class="mobile-filter-panel hidden" id="mobileFilterPanel">
        <div class="mobile-panel-header">
            <h2 class="panel-title">
                <span class="icon">‚öôÔ∏è</span>
                Filter & Einstellungen
            </h2>
            <button class="panel-close" id="mobileFilterClose" aria-label="Filter schlie√üen">
                <span class="close-icon">‚úï</span>
            </button>
        </div>
        <div class="mobile-panel-content" id="mobileFilters">
            <!-- Filter content will be inserted here -->
        </div>
    </div>

    <!-- Incident Detail Modal -->
    <div class="modal hidden" id="incidentModal">
        <div class="modal-backdrop" id="modalBackdrop"></div>
        <div class="modal-container">
            <div class="modal-header">
                <h2 class="modal-title" id="incidentModalLabel">
                    <span class="icon">‚ÑπÔ∏è</span>
                    Einsatzdetails
                </h2>
                <button class="modal-close" id="modalClose" aria-label="Modal schlie√üen">
                    <span class="close-icon">‚úï</span>
                </button>
            </div>
            <div class="modal-body" id="modalBody">
                <!-- Content will be populated by JavaScript -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="modalCloseBtn">
                    <span class="btn-icon">‚úï</span>
                    Schlie√üen
                </button>
                <button class="btn btn-primary" id="showOnMapBtn">
                    <span class="btn-icon">üìç</span>
                    Auf Karte zeigen
                </button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="app-footer">
        <div class="footer-container">
            <div class="footer-main">
                <p class="footer-notice">
                    <span class="warning-icon">‚ö†Ô∏è</span>
                    <strong>Hinweis:</strong> Diese Daten dienen nur zur Information. 
                    Bei Notf√§llen w√§hlen Sie 
                    <a href="tel:110" class="emergency-link">110</a> (Polizei) oder 
                    <a href="tel:112" class="emergency-link">112</a> (Feuerwehr/Rettungsdienst).
                </p>
                <p class="footer-sources">
                    Datenquellen: Polizeipressemitteilungen, √∂ffentliche Berichte. 
                    Letztes Update: <span id="lastUpdate">-</span>
                    <br>
                    <small>Entwickelt mit ‚ù§Ô∏è f√ºr mehr Transparenz und B√ºrgern√§he</small>
                </p>
            </div>
            <div class="footer-brand">
                <span class="brand-text">
                    <span class="shield-icon">üõ°Ô∏è</span>
                    Blaulicht Atlas 24
                </span>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
            crossorigin=""></script>
    
    <!-- Filter Component -->
    <script src="components/filters.js"></script>
    
    <!-- Main Application Script -->
    <script src="main.js"></script>
</body>
</html>